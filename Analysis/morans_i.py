import numpy as np
import matplotlib.pyplot as plt
import os
from scipy.sparse import load_npz
from scipy.spatial.distance import euclidean
from skimage.measure import regionprops

def load_mask_to_3d_matrix(filename):
    shape_image = (188, 120)
    sparse_wrong_shape = load_npz(filename)
    wrong_shape = sparse_wrong_shape.todense()
    masks = np.zeros((shape_image[0], shape_image[1], wrong_shape.shape[1]))
    for i in range(wrong_shape.shape[1]):
        masks[:, :, i] = np.reshape(wrong_shape[:, i], shape_image)
    return masks

# Different distance matrices
def overlap_based_distance(masks):
    weight_matrix = np.zeros((masks.shape[2], masks.shape[2]))
    for i, image_0 in enumerate(np.rollaxis(masks, 2)):
        #print('{}/{}'.format(i+1, masks.shape[2]))
        for j, image_1 in enumerate(np.rollaxis(masks, 2)):
            overlap = np.logical_and(image_0, image_1)
            if overlap.sum() > 0:
                weight_matrix[i, j] = 1
    return weight_matrix

def centroid_inverse_distance(masks):
    weight_matrix = np.zeros((masks.shape[2], masks.shape[2]))
    for i, image_0 in enumerate(np.rollaxis(masks, 2)):
        print('{}/{}'.format(i+1, masks.shape[2]))
        for j, image_1 in enumerate(np.rollaxis(masks, 2)):
            centroid_0 = regionprops((image_0 > 0).astype(int), image_0)[0].centroid
            centroid_1 = regionprops((image_1 > 0).astype(int), image_1)[0].centroid
            dist = euclidean(centroid_0, centroid_1)
            if dist > 0:
                weight_matrix[i, j] = 1/dist
    return weight_matrix

def moran_i(filename):
    masks = load_mask_to_3d_matrix('/home/romano/Documents/ContinuousGlobalSynchony/Masks/masks_{}.npz'.format(filename))
    weight_matrix = centroid_inverse_distance(masks)

    x = np.loadtxt('/home/romano/Documents/ContinuousGlobalSynchony/SynchronousEventParticipatingNeurons/{}_participating_neurons_{}.csv'.format(filename[:3], filename[4:]).replace('_results_', '_'), delimiter=',')
    x = np.sum(x, axis=1)
    xbar = np.mean(x)
    morans_i = 0
    for i, eli in enumerate(x):
        for j, elj in enumerate(x):
            morans_i += weight_matrix[i, j]*(eli - xbar)*(elj - xbar)
    denum = 0
    for i in x:
        denum += (i - xbar)**2
    morans_i /= denum
    morans_i *= len(x)
    morans_i /= np.sum(weight_matrix)
    return morans_i

def moran_i_split(filename):
    masks = load_mask_to_3d_matrix('/home/romano/Documents/ContinuousGlobalSynchony/Masks/masks_{}.npz'.format(filename))
    weight_matrix = centroid_inverse_distance(masks)

    xs = np.loadtxt('/home/romano/Documents/ContinuousGlobalSynchony/SynchronousEventParticipatingNeurons/{}_participating_neurons_{}.csv'.format(filename[:3], filename[4:]).replace('_results_', '_'), delimiter=',')
    morans_is = []
    for x in xs.T:
        xbar = np.mean(x)
        morans_i = 0
        for i, eli in enumerate(x):
            for j, elj in enumerate(x):
                morans_i += weight_matrix[i, j]*(eli - xbar)*(elj - xbar)
        denum = 0
        for i in x:
            denum += (i - xbar)**2
        if denum == 0:
            continue
        morans_i /= denum
        morans_i *= len(x)
        morans_i /= np.sum(weight_matrix)
        morans_is.append(morans_i)
    return morans_is

def main():
    l = os.popen('ls /home/romano/Documents/ContinuousGlobalSynchony/Masks').read()
    l = l.split('\n')[:-1]
    l = [i[6:-4] for i in l]
    cbl = []
    ctx = []
    for i in l:
        print(i)
        moran = moran_i_split(i)
        if type(moran) != type([]): # If not list, make list
            moran = [moran]
        if i[:3] == 'cbl':
            cbl.extend(moran)
        if i[:3] == 'ctx':
            ctx.extend(moran)
    print(cbl)
    print(ctx)
    plt.subplot(1, 2, 1)
    plt.hist(cbl, bins=25)
    plt.ylabel('Count')
    plt.xlabel("Moran's I")
    plt.title('Cerebellum')
    plt.subplot(1, 2, 2)
    plt.hist(ctx, bins=25)
    plt.xlabel("Moran's I")
    plt.title('Cortex')
    plt.show()

def mainer():
    cbl = [0.0023915229812648373, 0.10207498119973156, -0.006749768509739656, 0.05755262197442971, 0.004961315258022632, 0.025792066123754984, 0.002069078392343812, 0.02317807835782317, 0.0351325354903255, 0.02969010974703336, 0.008551470258869551, 0.019013016678262516, 0.02700948109138239, 0.01223706500640389, 0.020587094148475687, -0.005390123922684219, 0.011056126173398075, 0.02542268483207071, -0.006378817902322639, 0.006055692049687341, 0.11333816535439817, 0.05851132980251668, 0.023299139803950496, 0.004306307991088287, 0.06298788423135449, 0.03427458012365332, 0.05563004392418767, 0.0324678853291108, 0.01291664725825632, -0.00023243006702743785, 0.028706252290299182, 0.09384238410787649, 0.02843576177731603, 0.06767839145923958, 0.049000424716452835, 0.034061170448843985, 0.019447327468407733, 0.01669394387201323, 0.02109572552658494, 0.04125862348021261, 0.011551867672415774, -0.004154945963537478, -0.004869657444509826, 0.05940673973015805, 0.005929318076862846, 0.013421422546522083, 0.07010533202952124, 0.004034596766430351, -0.0017703381736058452, -0.02622687540967185, -0.01852816913517218, 0.0896660188433093, 0.028800000811479102, 0.023592769518549585, 0.019658102373900734, 0.013273726313180696, -0.014827644586987565, -0.011283883771007357, -0.018302476213997068, 0.011004702689520713, -0.01661488482760858, 0.06783715528029778, 0.05133004740847983, -0.024249676005762104, -0.0011805140213916152, 0.02511683484915596, 0.030171110876281663, 0.01970727887451647, 0.03831933136811437, 0.0023826802128251736, 0.03609283673907336, 0.0014628449662605209, 0.0800457662733196, -0.015090850331468458, 0.003908117646344344, -0.0018444544864576584, 0.03357612334692442, 0.0287718503196227, 0.008212658960653178, 0.005024626550791976, 0.006557577805925516, -0.018438285340429253, 0.019320689532082044, 0.07602274505378316, 0.021423056832243364, 0.09820821846163787, 0.07455129364136134, 0.025989333874260022, 0.04809935108590631, 0.03628091090965536, -0.012324201579713506, 0.018108486013914484, -0.008027588375267673, 0.06925687404017679, -0.007439725543310501, -0.0008475725206866148, 0.049917905553785176, 0.08045819362193533, 0.04243387594250706, 0.07418975980011064, -0.012343226817512282, 0.009458386444586686, 0.02468399448591574, -0.005016832404937883, -0.0037626399334719472, -0.012541774730332926, 0.015953911396930677, 0.003160713100504503, 0.007439697656457647, 0.11483443385199205, -0.02179729586097306, 0.040861176695796635, -0.044415683168285695, 0.004882017793071773, -0.02112448026698174, 0.03431830233500608, 0.05963515083970426, -0.024884978136007315, -0.004049712473882961, 0.026573249296954305, 0.006933011719055324, 0.01805307834036034, 0.018435620574951458, 0.005846174438073191, -0.01026082956519477, 0.004281301139968586, 0.0743317945389672, -0.002553923625673778, 0.020464437201158, -0.010634173098290737, -0.0033835122925596657, -0.003414110973556613, 0.03683619187258265, -0.006781627177349634, -0.005165534350165222, -0.006808549551637542, -0.011254874783311674, 0.05709862830193371, 0.021229370638511397, -0.010690609608791061, 0.000717553846798599, -0.007793119781802951, -0.004375726880632403, -0.005165534350165222, -0.005094318887078139, 0.10652430032245834, 0.007074845370510461, 0.004269387119916189, -0.007817750472165473, -0.0065164405207751835, -0.005117392838480134, -0.00554986599648754, -0.005165534350165222, 0.02449288530692767, 0.07774088425130435, -0.005165534350165222, -0.006797918781617734, 0.06608230818868886, 0.02830665199983715, 0.06528700795062374, 0.05975630770545958, 0.020029850157053202, 0.03369829939154628, -0.004835120370364834, -0.0010264005896495245, -0.008101828939636404, 0.0394512315258971, 0.03835019327661101, 0.04447814775429466, 0.01789528398421358, 0.028453631022991865, 0.002189711061913239, 0.020088584351311035, -0.007713065663459387, 0.030478266320286666, 0.1163043685406089, 0.04116050171101713, 0.009546264582793867, 0.02295675438123788, 0.06876768103924079, -0.004375726880632403, 0.05782990426085014, 0.023999537650758677, 0.018081560397146042, 0.09602980281075081, 0.0049512171827257295, 0.026940463208578864, -0.0006127993652238255, 0.028341838651095897, 0.05236536535408337, 0.05701855824417902, 0.09915437075637906, 0.02622029941856884, 0.06994091556162817, 0.06364088642717816, 0.07560072059846443, -0.0061563129863584365, 0.0291812387857732, 0.014554723232708287, 0.03441437053200804, 0.015627451963273586, 0.031202101603885025, 0.018721901131325294, 0.07687335401098698, 0.02915371367820019, -0.010763867094138199, 0.01817039244572798, 0.04287408011793041, 0.04473301025105892, 0.014982600202842939, -0.007100127077917437, 0.02009308248588562, 0.03560563224290921, 0.027314382776542103, 0.007005318759210757, 0.008690499136640294, 0.04281182449564592, 0.03108525718581213, 0.10043899477313097, 0.0447843364160461, 0.05188733583632997, 0.02958190645077996, 0.009512771275015193, 0.0496509444339802, 0.017510732778685995, 0.13563722439753792, 0.03304179440257582, 0.07925965332398384, 0.05880847160497807, 0.08624688398984336, 0.04104443510022268, 0.06281010410289727, 0.018338461154853408, 0.0454333769812107, 0.02527586218866666, 0.06887405173292911, 0.026216627386825078, 0.025847851150256052, -0.008011556847648269, 0.051319866416784626, 0.07607930497372217, -0.00576947073738746, 0.0051591516823299224, -0.003843468592217172, 0.01618281497001976, 0.030906528334585532, 0.03967889107477653, 0.02034244937339426, -0.0061211213482726115, 0.005035227920453511, 0.031141885058993703, 0.044138153488264616, 0.08973421108400423, -0.005298352966921915, -0.0061398157925432835, -0.007936156809801111, 0.12064274206005643, 0.1592671328551698, 0.05439363119633759, 0.033627398572564186, 0.021585964897404147, 0.016820821071774343, 0.021362003782495347, 0.009682631520230165, 0.13052771261566729, -0.0030977153071752887, 0.02555494584508636, 0.01445974584821355, -0.006649332754381444, -0.008610893707424912, -0.0008279501267898995, 0.030724511298370845, 0.019561975669949015, 0.006241944153924521, -0.005025186028653503, -0.0009087334789404426, 0.0047392539057228705, -0.0010207322674942658, 0.004971360774890821, -0.0020440734283026655, 0.021151725028370278, -0.007760125810239003, -0.009736896342660548, 0.02497298773276338, 0.02953243548045672, 0.010108936685197202, 0.008503021148325421, 0.024515215627929722, 0.04092268064978011, -0.00540274142519054, 0.042871751904254345, 0.025224965322468176, 0.01778557001451651, 0.07116837400374545, 0.023000760353394663, 0.07075894426040272, 0.035620260868396966, -0.008528249205736055, 0.055295786607806506, 0.04227234132597791, 0.009127075159107616, 0.10355051365140407, 0.025189177114943916, 0.12314849771364415, 0.031591147191989584, 0.043146956006117586, 0.09215859511344182, 0.05649622731621493, 0.017090911659919262, 0.08274799236647501, 0.00625654698632022, 0.06495978589239065, 0.02767578160640987, 0.040985284570417876, 0.04911197882006428, 0.11061712434745388, 0.004070870962126135, 0.04255790606056339, 0.01722887509712259, 0.006760018178165774, 0.019705724003160764, 0.018532173251901773, -0.004729552801854672, -0.005589543205299188, 0.020171757424277865, 0.04823569707836515, 0.03398867521832151, 0.03486824575711064, 0.016842053821746528, -0.009059729117885837, 0.07674595339815705, 0.02964656407003381, 0.04111016113673522, -0.004684092747063532, 0.02742193290197471, 0.02804243536765907, 0.025222271234244288, 0.04362119831598715, -0.0031539458361696223, 0.015504958801427446, 0.032503877724164874, 0.043054249352704355, 0.08486520003313444, 0.08631943155839207, 0.012878286690936335, 0.015954820015355666, 0.021793761685234395, 0.030810662328411512, 0.0060820092597275305, 0.04098647238354837, 0.03588085681322067, 0.03526977738405573, -0.008295803526744382, -0.00865604121633234, -0.00127842642908069, 0.036924300897612665, 0.02367038810429941, -0.005521557603340318, 0.03724736618574187, 0.06892946845889696, -0.002634468068763361, -0.0013420943296298816, 0.028886105728006865, -0.008370697424785288, 0.03083772125192643, 0.054939386260162676, 0.04256187970090973, 0.014315243281301902, 0.01651657207720631, 0.07297701803234644, -0.004009098269269789, -0.0056895348837780356, 0.0892134925570615, 0.0030996008446485023, 0.0578546385517807, 0.0584813744241399, 0.03756575713981093, 0.03861823683274221, 0.029568487718465188, 0.02081231673199407, 0.006747124566008175, 0.015429012300066389, 0.009248134081026252, 0.0012864989238889923, 0.1401442561625034, 0.037147340506024744, 0.037285719689519194, 0.01125905101612161, 0.0492295151364899, 0.0031916010659623433, 0.08103749904646397, 0.052975826735256, 0.028165999256093713, 0.03697819361154967, -0.004593684517958145, 0.025720455862056787, 0.03132405686190375, 0.018578083383888867, 0.048004717722681764, 0.041774717479865546, -0.004863573761830527, 0.002441008904031907, 0.05323245042345311, 0.03354409634949479, 0.013011663416038073, 0.034719731696950244, 0.0625829322951433, 0.13808575497202327, 0.005665421107425708, 0.01766505411928021, 0.017917969618269372, 0.0066149969357572535, 0.0186331399097804, -0.00048804689951547763, 0.02781526426268731, 0.02715007522261812, 0.02949647074654505, 0.013996202836052962, 0.02722297807958673, 0.027402540705566036, 0.05499685832094653, 0.012264252031586912, 0.07017473155025442, 0.03684617293091302, 0.07404113867209071, -0.003557405021085702, 0.05723297969095752, -0.0017577848467886963, 0.01402675973172668, 0.04629269759055571, 0.026992592803263122, 0.005554695333844841, -0.009696689279453382, 0.009594348237657842, 0.07813015071079595, 0.008950342287766538, 0.0477836969456459, 0.032485265434716123, -0.0013143726508686785, 0.052931516064553416, 0.0822570274411455, 0.08117810749241494, 0.02745366718428038, -0.004753696129862024, 0.028556976218527177, 0.0008489167084585515, -0.005359029415456338, 0.01738802132432928, 0.01708865050394042, 0.020725989796224125, 0.03724042022017542, 0.029897748790537353, -0.005183643505106985, 0.014031235159460729, 0.02258632346036044, 0.069087105969811, -0.01019869756987584, -0.12446341068357582, -0.09560351368471076, 0.012331769301237375, -0.012442803194448241, 0.1295419460467686, -0.1753207222447855, -0.014560779689977509, -0.0015789493924850454, 0.007080318111295795, 0.0751970275576563, 0.07970410249078534, -0.16396838240124373, -0.007022943784502768, -0.17549385308271512, -0.15959838013453642, -0.056388820203808684, 0.014770088686205432, 0.09310460287334575, 0.057182986622939504, 0.06939880286267347, 0.006890770581383879, 0.36590226031966677, 0.02490173644632538, 0.14747122025596743, -0.1458987972762904, -0.009849714041253805, -0.021716399985207444, -0.02781825633163963, 0.004223609706594759, 0.03151285687700748, -0.019758685742064228, 0.02582806366648767, 0.11215029069076554, -0.02940738860267514, 0.030260949060905654, 0.004336526557172278, -0.03762098978637857, -0.00794675254075667, -0.020639416515252335, -0.012640028192519725, -0.008350608323454384, 0.02471761518184057, 0.08686631515893357, -0.04970368276233506, -0.008417801032978208, 0.009728610521188279, -0.019215089311676026, 0.04716813643238167, -0.005506512171335721, 0.017587159772701463, 0.0655469124317423, -0.02296023199972018, -0.016801528289487493, 0.06877437469547884, -0.004540976717936303, 0.0147449361792614, -0.01816697308295885, 0.028498830027262778, 0.0037483571062654573, 0.010014872263258569, 0.010673255319971894, -0.016107591367123978, 0.027184775996967274, -0.000828842261872563, -0.0012353398519395252, 0.021946473334475938, 0.015822828363621276, 0.07431556169133781, -0.013757258549855812, 0.025015702620019297, -0.0011855646535563643, -0.01744321422704962, -0.014406617912289699, -0.02354836824770687, 0.020534159575913657, 0.019208966396777404, 0.006657848373702169, 0.02839208522048722, 0.0789449857509886, 0.007686731326443392, -0.022245252866556594, 0.08858702444269953, 0.1662875951179946, 0.005698793239211308, 0.023028218978714432, 0.0008394455945384248, 0.09781881994063225, 0.012592860577082638, 0.04756125095944428, 0.0179682417590186, 0.018355740444285017, 0.05182819371150032, -0.02031010252363233, -0.01819344442424777, -0.025757700251803614, 0.0014593660709563063, -0.0026601622861293574, 0.0479250689026144, 0.017017130542638183, 0.02190693957013356, 0.03112666003546912, 0.1336458028040752, 0.10058773173864234, 0.07521595562216644, -0.018203121166634206, -0.007378026284054756, 0.002759693356024069, 0.04252920412755207, 0.06500873578812426, 0.05131403826916079, 0.05489274176013395, -0.013725656700792224, 0.033579694908148126, -0.005563536543082634, 0.012664456038756532, 0.031525474751051184, 0.06329967785516265, 0.048518964911528885, 0.014621377643880908, -0.006239002864421827, -0.010241091806051338, -0.007951472018331572, 0.0411976167385366, 0.04448714716074177, 0.058250599687689565, 0.032043503282847434, 0.017521813327496114, 0.05881720756782875, 0.007605183929588528, 0.013944042331569359, 0.020621620480273467, 0.048668666967634625, 0.04232854438376436, 0.05295992856697539, 0.030091447497260646, 0.010771041432227152, 0.018725962734992132, 0.03671536015727659, 0.04495744602982215, 0.1050707562141923, 0.07152537271559291, 0.046695702441177954, 0.04684092277850794, 0.06718109937442425, 0.02817486666916144, 0.016277054048399433, 0.037207341503985636, 0.029300488489983515, 0.0008165474762710476, 0.007453675934752601, 0.09231535337836413, 0.015313411532061965, 0.04968935852424309, 0.07186672057348506, -0.004680796225569137, 0.041253982407852996, 0.03003985352308801, -0.0009484694680984635, 0.0872529791156159, 0.016304151475384603, 0.02033804060019826, 0.0013303657356772073, 0.03384373959591348, -0.005071481102306364, 0.05149223137569128, 0.00035088003742691023, 0.014258397741608095, 0.008002963813061216, 0.0034595499165285593, -0.003446918140964216, 0.006105149838898294, 0.023639595137890507, 0.017297699970921603, 0.025056030599072528, 0.031293090848737624, -0.011226402930373403, 0.08105244845784633, 0.06360141261469023, 0.009679041288662482, 0.05598333743618565, 0.014236914895661782, 0.048772040573888224, 0.017050941879035962]
    ctx = [0.03254014543338102, 0.012954676442953757, 0.025091064739968753, -0.011345506709981116, 0.01911539057534863, 0.011100811904061321, 0.015337468217266842, 0.03085703970679179, 0.01207477972666812, 0.010421011709858648, 0.02549716826824445, 0.003331635960482987, 0.09894011796441242, 0.0972999715500359, 0.018200489005812115, 0.007088440485398871, -0.00737604452330648, -0.0048700911118466994, -0.004422096691723739, 0.0030370396847318303, 0.00219872608192663, 0.006951810990582625, 0.0022383684265398053, 0.018664017580362388, -0.0030259247512672877, 0.0008138720812549984, -0.0006152472846499665, 0.0029733311552068925, -0.001523995637574908, 0.10360795102295599, 0.006541302335430603, -0.0028526058272197777, -0.0048487423797503055, 0.003563711295722439, 0.0028950844616691725, -0.001636510115786919, 0.006184993674279372, 0.06155697165709967, -0.0008265766283461319, -0.0030933995276083643, -0.005107283494537564, 0.005251144121863639, 0.006311724392223167, -0.003033262584356177, 0.00767919132412621, -0.007221044331804237, 0.00614543831925299, 0.012620794152693203, 0.024120966562764124, 0.003499623353038222, 0.027965314697990084, -0.01461866291500472, 0.13712665073588703, -0.01383275355994164, -0.018083826856938406, -0.014212513221660098, 0.016638378423719284, -0.02354650112620341, 0.021880109158801123, -0.013064907980165628, -0.01625814681847585, 0.0021851360235566305, 0.19482612947156494, -0.00013746577564602478, -0.001601070597226343, -0.02106514548414969, -0.00712094854247598, -0.009344581858378475, 0.01192428335414253, -0.008903875805581678, -0.021138036270978357, -0.052625451970227034, 0.002653606087283193, -0.011175566936570852, -0.011232045166037517, -0.013250456227252145, 0.032824474300912516, 0.033395591712138704, -0.012952822504059458, -0.011175566936570852, 0.0060647039435612615, -0.008786126459242649, 0.021709142032664545, 0.017925762769758213, -0.017041304937026085, -0.013504887480014239, 0.012682249891893725, -0.012626441745147706, -0.0026348729904443237, -0.013064907980165628, -0.03834587101176084, -0.017295453079357412, 0.3513580488452017, -0.07958358944340108, -0.013114761501455624, -0.03409488818954341, -0.053481247079573, -0.04528857301140266, -0.029811944727532753, -0.030787497746254954, -0.024898215168783426, -0.023875075128662885, 0.1726912574281016, -0.015230560930069813, 0.08499609227877447, 0.08386457085405902, 0.006526693641073016, -0.0006898755410080554, -0.05106978446968109, -0.04069274104940997, -0.007277008701570214, 0.06463356731848138, 0.05235296820467644, 0.0006407304913622919, -0.05258856474690321, -0.06530578039505552, -0.047740480609165595, 0.02105938776525371, -0.010952303883954788, -0.008853392445408725, 0.037298554601479385, 0.003049994566826749, 0.031089160327917892, 0.000934200291118772, 0.00401070233582489, 0.014238786583721819, 0.007568504805606392, 0.019117221872995166, 0.100365696892311, -0.012388716863440343, -0.0037475863286046177, -0.011082293735680199, 0.05448937676808406, 0.017388904086570785, 0.01288347158126668, 0.02986723335802967, -0.009595784898539357, 0.088457642065108, -0.006432352332944186, -0.011623807452782662, 0.0009988678327960407, -0.007952673349016273, -0.002371133437125891, -0.008609187807824005, 0.04279220096099601, -0.011777271318290776, 0.0503002968506419, 0.012980190685823883, 0.005229128599423498, 0.003980155273607946, 0.010399848933867844, -0.01750538258821864, -0.009748764219171313, 5.412383565845989e-05, -0.003030921518775358, -0.006939817317708277, -0.005129315633084578, 0.11658206396677005, 0.0010483900296977136, -0.028047116572010783, -0.016366926143029942, 0.2989888517094264, -0.014129685915460051, 0.04892587588132666, 0.12490815409297717, -0.005466619994817371, 0.05648484428003223, -0.02582848779894166, 0.017651805737454326, -0.013988914405809336, -0.017763298091554497, -0.00025669295235725755, 0.0017291144449741599, -0.008677547253193736, 0.0007615242881229481, 0.0011097319648781436, 0.004482811811222762, 0.011783441319295485, 0.07624194395661886, -0.003092044715247302, -0.0024974273099445895, 0.005418047273166801, -0.004244445636773294, 0.017653853064295167, -0.0033179164498648907, 0.008212038881379054, 0.02252018866409115, 0.008182926711462452, 0.016358530832692637, 0.02995301773946743, 0.021581317671917517, 0.032578950585662604, 0.044986743017968366, -0.003639334584696096, 0.014587776717933416, -0.0030214080809048307, 0.04238936048457828, 0.034266241535787736, -0.01072772840689166, 0.0036586600423396927, 0.0025124632791014866, 0.02453557538729894, 0.00447003253752875, -0.002535233552141766, 0.018576199597947197, 0.021678734183160134, 0.019891654744693593, -0.0008659786068616303, 0.005064185853478997, 0.004037897493804516, 0.002810251200079773, 0.005673728791886836, 0.0008535495064738676, 0.0008160428893405835, 0.010292166056951196, -0.008493879014480904, 0.020811879370938983, 0.014035033189534314, 0.012124631704677254, 0.0220890016181117, 0.017159277603835267, 0.03287893446096374, 0.005482035040401404, 0.0029554142982336916, -0.0032322380141485614, 0.030589227240199413, -0.005146869197087673, 0.011152703789959428, 0.0017939399857130058, -0.0012795151096597348, 0.0054406498189169495, 0.0009294986960955105, 0.022969712395523378, 0.020316219140621688, 0.006478704106597824, 0.04800361889036144, -0.00349901406890186, -0.004213476311219093, -0.004576012439393533, -0.002458197534919316, -0.0042892197716446305, 0.017469740041163577, 0.029711205655969936, 0.04883430882211811, -0.003014029464299609, 0.020038312846165845, 0.008684598368722351, -0.0008871459875969305, 0.02983965555920739, 0.010172290861491901, -0.0020122634191435352, 0.005538291285813705, 0.012375280495919322, -0.003104669158556653, -0.0035159878979263816, 0.04300171419795085, 0.07542980055269817, 0.0020691523427467167, 0.03534580323414158, 0.012392768123283528, 0.01790756779946598, 0.01549178311541416, 0.022857651213176892, 0.02547263953299129, 0.00951651802892313, 0.01573127345966105, 0.03949879484721161, 0.014842256322835878, 0.021595819267985553, 0.015243367773124222, -0.0016949809718068683, 0.039111532749502124, 0.042344568452911284, 0.0461327986326128, 0.03823598688664357, -0.0003247852381622876, -0.0030616407382177283, 0.004571169308236945, 0.02405574821565432, 0.009334522893848748, -0.010337136633021134, 0.01959714238215649, 0.00444771245059733, 0.0013921803926162301, -0.001237102097788305, -0.004474847181048248, -0.0014954429434605673, 0.02425510515350598, -0.003848973734873596, 0.012478530432951215, 0.014579034225224791, -0.0006231256095266301, 0.017663059406230926, 0.0009494397850896411, 0.03781763814676088, 0.015545036549684463, -0.000307706041622653, 0.0052113357966853515, 0.03555815903586325, 0.04755826820937513, 0.04471354348799445, 0.0519325281944097, 0.0028750124212492084, 0.019663658879387542, 0.019682840639648518, 0.027215681236452315, 0.07550689404419737, 0.0007248569293456677, -0.0040365430968836566, -0.001248305282676627, -0.0012441037923141625, -0.00020743040240477076, 0.003507593177375231, -0.0036780624788817972, 0.008490249682078182, 0.010126780802474445, 0.020856425299658324, -0.0037903758666773192, 0.0033449361461437596, -0.0007761577501395138, -0.0004987109467378848, 0.09143087892500021, 0.041563615302618054, 0.008686901327002713, 0.04196009153070672, 0.005264945748099064, -0.006858674558699658, 0.10197733366197513, -0.0004319047631172079, 0.052549051834040954, -0.0045270979903389, 0.010566964588443306, 0.03686682345766262, 0.12893852067940909, 0.025716655108189688, -0.004597475742883269, 0.0034658117061394586, 0.024946377017775297, 0.16449866476798386, 0.019278310924034477, -0.005029400368943267, 0.006159646545523967, -0.0016673247102880406, 0.00036868796058408485, 0.027908052010976632, 0.014840863362693307, -0.0017730811043939112, 0.03168188333790738, 0.022129328100203977, 0.003290870316591486, -0.0009763761029659805, 0.010561451651697525, 0.01174083357524975, 0.01671656709141856, 0.0014111946326693908, 0.03670606903325277, 0.030809033225279087, -0.004703523219336767, -0.0010188033797496742, 0.0007486293764995222, -0.0028040953241699, 0.011191788579016445, 0.0005414810000958825, 0.009812054508869723, -0.0029477340483046698, 0.004006771636387654, 0.005517430819962672, -0.0031238262352400997, 0.03186703803496867, 0.01536789072640624, -0.002828695121760814, 0.00539377637146119, 0.02211907483007732, -0.0008641305259430763, 0.005872276603114488, -0.00312405651352303, -4.246846281056669e-06, -0.0024646835585181268, -0.002386035545007987, 0.0573522197371292, -0.0032810433899646777, -0.004305725903839171, -0.0067107135365346345, 0.07341817832639794, -0.0016152847401696903, -0.002641687731503948, -0.009638325352959698, -0.0012938567443255972, 0.0795973654167725, 0.049668580636415785, 0.02047345004251768, 0.011044330261704297, -0.0021542979595138424, 0.05392279471078094, 0.009486077320278051, 0.011747832211057112, -0.011194303867059137, -0.004893125769375621, 0.010451638460021515, -0.002714068071871809, -0.005147446368761751, 0.02162269938523504, -0.008463408551944182, -0.0014303281938693273, -0.00426539016574912, 0.0014100558842868986, -0.005093252852479232, -0.0039464255005664025, -0.0009154815381586613, -0.002828695121760814, 0.005043296509465862, -0.0038993771123636894, -0.0016419900662999645, -0.0030927481473968475, -0.0027061302402328086, -0.000660253227525283, 0.0027033982938610376, 0.061900197011251545, 0.0622977648414441, -0.006405553862353557, 0.02772709397605029, 0.09761678249984296, 0.003579075553206996, -0.00019930648407821898, -0.028180716272207855, -0.0024638420211575466, -0.004899910117501897, -0.0031987533643430288, -0.0034724362123881893, -0.0024981126422401433, -0.0029065185143907933, -3.557203326748605e-05, 0.01494497598471222, -0.00419817710895765, 0.005859514686243119, -0.0038054845220580097, 0.0012691928399765821, -0.003696452607159292, -0.0037735706410088497, -0.008576942559695166, 0.008126360460554021, -0.00780132711884102, 0.0240190039572898, -0.0007413701281831303, -0.012046866429128228, 0.0483644044138242, 0.03473031272160962, 0.0144305258661364, 0.04286256073856518, 0.022535781631585174, 0.06235577987228515, 0.024124576440797532, 0.023467603333511364, -0.006121884107153753, 0.003973315248109067, 0.006644030556772049, 0.019946922401158102, 0.019624492271975616, -0.0031338516491754534, 0.04093504948285807, 0.019720342406898177, 0.00665683945058949, 0.005977184067528484, -0.002463677436317783, 0.003510029056651086, -0.00023443830591508684, -0.007468293150434037, 0.030911696344996593, 0.008174139029746699, 0.03486802233203525, 0.014866386940013139, -0.010693252204885767, 0.0650572364475752, -0.011238134038151094, 0.04352050309458194, -0.0039025575135955884, 0.017034774299831607, 0.03278234868202344, -0.00388402690478798, 0.031403760134803636, 0.03290108389657835, -0.009937093866978474, 0.05501180545073674, -0.0027682588194132447, 0.017832379574598815, 0.023793934359518102, -0.01832138402752219, 0.039208869005263436, -0.0096494373438649, 0.06916999372575929, 0.031008914700421403, 0.020052945847364615, 0.04984025250786399, 0.032584226213519876, 0.024788688660172996, 0.0007538115838655865, -0.003948907285833119, -0.007985467678488595, -0.003733100777246197, -0.003993588180626896, 0.005322246720517752, 0.032922537767361405, 0.00043227417546862104, -0.006815427367141139, -0.00837280597037619, 0.0031260189266031743, -0.007625900725301682, -0.00022087094294040964, 0.0841322317576789, 0.08133033287313528, 0.0001413134247234973, 0.021574260029591525, 0.005973744844959677, 0.00731728404551932, 0.04439220083622513, 0.05340311870099272, -0.003938377701866667, 0.010825390201269493, 0.009229953980753372, 0.004367989484144044, 0.04886201464591739, 0.004059040023137549, 0.03759465825004317, 0.013236587045529173, 0.03250378637796458, 0.03651723767839538, 0.03186804315484249, 0.029939451822378164, -0.004908611465387672, 0.01741726270063444, -0.002893004413886963, -0.001745120798537782, 0.08029111809515568, -0.0035525922367213095, 0.012852780474362153, 0.051921011920910885, 0.019163792251816074, 0.022127430902522952, -0.00793241962456695, 0.027734770706128335, 0.01459950732217108, 0.07343734255891639, 0.01144422231984405, 0.04783502437903231, -0.005655771097312046, 0.021621787042085415, 0.030835509470556903, 0.03098730100994277, 0.025168774774467776, 0.017333276264903778, -0.005320963271579036, 0.004059672196993704, 0.032528900111741164, 0.027123392873688063, -0.007376572027441484, -0.010737254304159486, 0.008988213567222302, -0.0064884891585467765, -0.0024089987044427627, 0.021220062737458852, 0.027626563379215808, -0.004638251670635766, -0.008204274528096031, 0.0135802636659718, 0.031056997079924244, 0.004100250194316088, 0.0347268101794999, 0.029905621282538413, 0.002627655489941991, -0.005409742713051294]
    hist_cbl, edges_cbl = np.histogram(cbl, bins=50)
    hist_ctx, edges_ctx = np.histogram(ctx, bins=50)
    hist_cbl = hist_cbl/len(cbl)
    hist_ctx = hist_ctx/len(ctx)
    plt.plot(edges_cbl[1:] - (edges_cbl[1] - edges_cbl[0])/2, hist_cbl, label='Cerebellum')
    plt.plot(edges_ctx[1:] - (edges_ctx[1] - edges_ctx[0])/2, hist_ctx, label='Cortex')
    plt.legend()
    plt.xlabel('I')
    plt.ylabel('Prob')
    plt.show()

if __name__ == '__main__':
    mainer()
